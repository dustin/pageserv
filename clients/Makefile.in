# Copyright (c) 1997   Dustin Sallings
# $Id: Makefile.in,v 1.3 1997/03/14 00:52:50 dustin Exp $

MAJOR=2
MINOR=0
PATCH=0
VERSION=$(MAJOR).$(MINOR).$(PATCH)

CC=@CC@
INCLUDES=-I..
CFLAGS=-g $(INCLUDES) -DVERSION=\"$(VERSION)\"

LIBS=@LIBS@

LDFLAGS=-g $(LIBS)

PUSH_OBJS=pushqueue.o client.o
EMAIL_OBJS=parsemail.o client.o
SOURCES=pushqueue.c
EXES=pushqueue parsemail
NAME=clients
ARCHIVE=$(NAME)-$(VERSION)
STUFF=$(SOURCES) Makefile pushqueue.pl
JUNK=$(EXES) *.o *.core core

all: $(EXES)

pushqueue: $(PUSH_OBJS)
	$(CC) -o $@ $(PUSH_OBJS) $(LDFLAGS)

parsemail: $(EMAIL_OBJS)
	$(CC) -o $@ $(EMAIL_OBJS) $(LDFLAGS)

tgz: $(ARCHIVE).tar.gz

$(ARCHIVE).tar.gz: $(STUFF)
	rm -f $(ARCHIVE).tar.gz
	mkdir $(ARCHIVE)
	cp $(STUFF) $(ARCHIVE)
	tar -cvf $(ARCHIVE).tar $(NAME)
	rm -rf $(ARCHIVE)
	gzip -9v $(ARCHIVE).tar

clean:
	rm -f $(JUNK)
